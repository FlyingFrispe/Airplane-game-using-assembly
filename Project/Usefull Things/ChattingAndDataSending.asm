.MODEL SMALL
.STACK 64
.data
MESSAGES DB 30,?,30 DUP('?')
VALUE DB ?
MESSAGE_RECIVED DB 30,?,30 DUP('?')
.code
MAIN PROC FAR
MOV AX,@data
MOV DS,ax
CALL CLEARSCREEN
AGAIN:
MOV AH,1h
INT 16h
JZ NEXT
MOV AH,0
INT 16h
CMP AL,1bh
JE EXIT
MOV VALUE,AL
CALL PORTS_INTLIZATION
CALL SEND_DATA
NEXT:
CALL PORTS_INTLIZATION
CALL READ_DATA
MOV DL,AL
MOV AH,02
INT 21h
JMP AGAIN


EXIT:
MOV AH,4CH
INT 21H;back to dos
hlt
MAIN ENDP
NEWLINE PROC
MOV AH,2
MOV DL,0AH
INT 21H
MOV DL,0DH
INT 21H
RET
NEWLINE   ENDP
PORTS_INTLIZATION PROC
Mov dx,3fbh
mov al,10000000b
Out dx,al
mov dx,3f8h
mov al,0ch
out dx,al
mov dx,3f9h
mov al,00h
out dx,al
mov dx,3fbh
mov al,00011011b
out dx,al      
RET
PORTS_INTLIZATION ENDP

SEND_DATA PROC
Mov dx,3fdh
AGAIN1:
In al,dx
and al,00100000b
JZ AGAIN1
Mov dx,3f8h
Mov al,VALUE
Out dx,al
RET
SEND_DATA ENDP

READ_DATA PROC
Mov dx,3fdh
CHK:
IN AL,DX
AND AL,1
JZ CHK
MOV DX,03F8H
IN AL,DX
MOV VALUE,AL
RET
READ_DATA ENDP

CLEARSCREEN PROC
mov ah,00
mov al,02
int 10h
RET
CLEARSCREEN ENDP

END MAIN